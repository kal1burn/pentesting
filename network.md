## Network-Based Attacks

In a network attack, attackers are focused on penetrating the corporate network perimeter and gaining access to internal systems. Very often, once inside attackers will combine other types of attacks, for example compromising an endpoint, spreading malware or exploiting a vulnerability in a system within the network.

### Network Services

> ARP
> 
> DHCP
> 
> SMB
> 
> FTP
> 
> Telnet
> 
> SSH

### Man in the middle attack

Usefull nmap flags

> *   `-vv` (Increase verbosity)
> *   `-n` (No DNS resolution. This speeds up our scan!)
> *   `-sn` (No port scan)
> *   `-PE` (Use ICMP echo request queries. This is what is displayed in the output above)
> *   `-T4` (prohibits the dynamic scan delay from exceeding 10 ms for TCP ports. See `man nmap`).
> *   `--packet-trace` (Trace sent and received packets)

Performing a quick network scan:

```plaintext
nmap 192.168.1.1/24 -sn
```

### TSHARK

Intercept traffic with tshark and save it to a file:

```plaintext
tshark -i eth0 -w mytraffic.pcap
```

Read from a saved pcap file:

```plaintext
tshark -r mytraffic.pcap
```

List protocol hierarchy:

```plaintext
tshark ir mytraffic.pcap -z -io,ph -q
```

Filter http traffic

```plaintext
tshark -r mytraffic.pcap -Y http
```

Filter traffic between ip addresses:

```plaintext
tshark -r mytraffic.pcap -Y 'ip.src==10.0.2.15 && ip.dst==192.0.73.2'
```

Filter HTTP GET requests:

```plaintext
tshark -r mytraffic.pcap -Y 'http.request.method==GET' | more
```

Filter specific fields

```plaintext
tshark -r mytraffic.pcap -Y 'http.request.method==GET' -Tfields -e frame.time -e ip.src -e http.request.full_uri
```

Search for a specific string

```plaintext
tshark -r mytraffic.pcap -Y ‘http contains password’
```

```plaintext
tshark -r mytraffic.pcap -Y ‘http.request.method==GET && http.host==www.site.com' -Tfields -e ip.dst
```

See what browser the user is utilising:

```plaintext
tshark -r mytraffic.pcap -Y ‘ip.src==192.0.73.2 && http’ -Tfields -e http.user_agent

## ARP Poisoning

MITM Arp Posining sends unsolicited arp replys to the gateway and the target. 

See what other machines we can see on our network

arp -a
