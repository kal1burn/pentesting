
## Alternate Data Streams (ADS)

> *   Alternate Data Streams (ADS) are a file attribute only found on the NTFS file system.
> *   These data streams suffer from a bad reputation since they have been used and abused to write hidden data. Varying from data about where a file came from to complete malware files (e.g. [Backdoor.Rustock.A](https://www.symantec.com/security_response/writeup.jsp?docid=2006-060111-5747-99&tabid=2))
> *   Attackers can use ADS to hide malicious code or executables in legitimate files in order to  
>     evade detection.
> *   This can be done by storing the malicious code or executables in the file attribute resource  
>     stream (metadata) of a legitimate file.
> *   This technique is usually used to evade basic signature based AVs and static scanning  
>     tools.
> *   A file medatada can be found in Properties/Details

Creating a file (test.txt) with a hidden file inside (secret.txt).

```plaintext
notepad test.txt:secret.txt
```

Copy the payload to Temp directory.

Redirect the output of the payload into a new file.

```plaintext
type payload.exe > windowsupdate.txt:winpeas.exe
```

Create a symbolic link in System32

```plaintext
mklink wupdate.exe C:\Temp\windowsupdate.txt:winpeas.exe
```

Now we can execute the payload winpeas.exe by simply typing wupdate

```plaintext
wupdate
```
