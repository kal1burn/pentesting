# **SMB Enumeration (139, 145)**
Port 139 is used by SMB dialects that communicate over NetBIOS. It operates as an application layer network protocol for device communication in Windows operating systems over a network. For example, printers and serials ports communicate via Port 139.

Port 445 is used by newer versions of SMB (after Windows 2000) on top of a TCP stack, allowing SMB to communicate over the Internet. This also means you can use IP addresses in order to use SMB like file sharing.

## Using Using Nmap

#### path to nmap scripts

`cd /usr/share/nmap/scripts; ls |  grep smb`


- #### Get more information about SMB Server

`nmap -p 445 --script smb-protocols 10.10.10.10`

- #### Find accounts and maybe a default configuration

`nmap -p 445 --script smb-security-mode 10.2.17.228`

- #### Enumerate the sessions, find users name connected as users.
`nmap 	-p 445 --script smb-enum-sessions 10.10.10.10`

- #### Enumerate shares.
IPC is usefull if you find it, because it is a null session. a null sesion is like an anonymous session and you can get in as a guest.

`nmap -p 445 --script smb-enum-shares,smb-ls 10.10.10.10`

- #### Enumerate shares after authenticated.
`nmap -p 445 --script smb-emun-shares --script-args smbusername=administrator,smbpassword=password 10.10.10.10`

- #### Enumerate users after authenticated.
`nmap -p 445 --script smb-emun-users --script-args smbusername=administrator,smbpassword=password 10.10.10.10`

- #### Enumerate the server statistics to see how much data is sent and received, faild login attempts etc.
`nmap -p 445 --script smb-server-stats --script-args smbusername=administrator,smbpassword=password 10.10.10.10`

- #### Enumerate domains.
`nmap -p 445 --script smb-enum-domains --script-args smbusername=administrator,smbpassword=password 10.10.10.10`

- #### Enumerate groups.
`nmap -p 445 --script smb-enum-groups --script-args smbusername=administrator,smbpassword=password 10.10.10.10`

- #### Enumerate services that are running
`nmap -p 445 --script smb-enum-services --script-args smbusername=administrator,smbpassword=password 10.10.10.10`
