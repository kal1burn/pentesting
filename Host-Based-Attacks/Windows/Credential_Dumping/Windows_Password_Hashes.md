
## Windows\_Password\_Hashes

**\*Elevated privileges are required to interact with lsass process.**

> *   Hashing is the process of converting a piece of data into another value by using a hashing algorithm.
> *   The Windows OS stores hashed user account passwords locally in the **SAM (Security**  
>     **Accounts Manager) database**.
> *   Authentication and verification of user credentials is facilitated by the Local Security Authority  
>     (**LSA**).
> *   Windows disables LM hashing from 2003 and utilizes **NTLM** hashing from Windows Vista onwards.

## SAM Database

> *   SAM (Security Account Manager) is a database file that is responsible for managing  
>     user accounts and passwords on Windows. All user account passwords stored in  
>     the SAM database are hashed.
> *   The SAM database file cannot be copied while the operating system is running.
> *   The Windows NT kernel keeps the SAM database file locked and as a result,  
>     attackers typically utilize in-memory techniques and tools to dump SAM hashes  
>     from the LSASS process.
> *   In modern versions of Windows, the SAM database is encrypted with a syskey.

## LM Hashing Algorithm

> *   LM is the default hashing algorithm that was implemented in Windows operating  
>     systems prior to NT4.0.
> *   LM hashing is generally considered to be a weak protocol and can easily be  
>     cracked, primarily because the password hash does not include salts,  
>     making brute-force and rainbow table attacks effective against LM  
>     hashes.

## NTLM Hashing Algorithm

> *   NTLM is a collection of authentication protocols that are utilized in Windows to facilitate  
>     authentication between computers. The authentication process involves using a valid  
>     username and password to authenticate successfully.
> *   From Windows Vista onwards, Windows disables LM hashing and utilizes NTLM  
>     hashing.
> *   When a user account is created, it is encrypted using the MD4 hashing algorithm, while  
>     the original password is disposed of.
> *   NTLM improves upon LM in the following ways:
>     *   Does not split the hash in to two chunks.
>     *   Case sensitive.
>     *   Allows the use of symbols and unicode characters.
