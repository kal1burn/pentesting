
## Dumping and Cracking Hashes on Windows

**\*\*\*Dumping Hashes check - system and host base attacks**

**Tools to dum hashes:**

\-Meterpretr “hashdump” command

\-Mimikatz

**Tools to crack the hashes**:

\-John the Ripper

\-Hashcat

_\*SAM Database. The Windows stores hashed passwords in Security Accounts Manager_ (SAM) database. Files from SAM cannot be copied while OS is running. To dump hashes from LSASS process we can use in-memory techniques, and administrator privileges are required. The SAM database is encrypted with a syskey in modern versions of Windows. If Repair Utility was used before, a copy of the SAM Database was made.

\*Authentication and verification of user credentials is done by Local Security Authority(LSA)

\*Windows uses NTLM hashes from Vista onwards. NTLM uses MD4 hashing algorithm.
after exploiting the target and getting administrative privileges, migrate the process id to lsass

```plaintext
pgrep lsass
<722>
migrate 722
```

Dump the list of user accounts and their hashes

```plaintext
hashdump
```

Create a new file like **hashes.txt** on your system and paste the hashes (with users) there. 

#### Crack the hashes using John the Ripper. We need to provide the format of the hash

\*you can also use it without specifying wordlist.

```plaintext
john --format=NT hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

#### _Using **hashcat**_

Must specify the hash type by using the attack mode(-a), the hash type id(-m),  and the wordlist

```plaintext
hashcat -a3 -m 1000 hashes.txt /usr/share/wordlists/rockyou.txt
```
